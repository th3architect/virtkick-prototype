/*
 * noVNC: HTML5 VNC client
 * Copyright (C) 2012 Joel Martin
 * Licensed under MPL 2.0 (see LICENSE.txt)
 *
 * See README.md for usage and integration instructions.
 */
"use strict";var Util={};Array.prototype.push8=function(e){this.push(255&e)},Array.prototype.push16=function(e){this.push(e>>8&255,255&e)},Array.prototype.push32=function(e){this.push(e>>24&255,e>>16&255,e>>8&255,255&e)},Array.prototype.map||(Array.prototype.map=function(e){var t=this.length;if("function"!=typeof e)throw new TypeError;for(var n=new Array(t),r=arguments[1],i=0;t>i;i++)i in this&&(n[i]=e.call(r,this[i],i,this));return n}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;for(n=0>n?Math.ceil(n):Math.floor(n),0>n&&(n+=t);t>n;n++)if(n in this&&this[n]===e)return n;return-1}),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),Util._log_level="warn",Util.init_logging=function(e){switch("undefined"==typeof e?e=Util._log_level:Util._log_level=e,"undefined"==typeof window.console&&(window.console="undefined"!=typeof window.opera?{log:window.opera.postError,warn:window.opera.postError,error:window.opera.postError}:{log:function(){},warn:function(){},error:function(){}}),Util.Debug=Util.Info=Util.Warn=Util.Error=function(){},e){case"debug":Util.Debug=function(e){console.log(e)};case"info":Util.Info=function(e){console.log(e)};case"warn":Util.Warn=function(e){console.warn(e)};case"error":Util.Error=function(e){console.error(e)};case"none":break;default:throw"invalid logging type '"+e+"'"}},Util.get_logging=function(){return Util._log_level},Util.init_logging(),Util.conf_default=function(e,t,n,r,i,o,s,a){var l,u;l=function(t){return o in{arr:1,array:1}&&"undefined"!=typeof t?e[r][t]:e[r]},u=function(t,n){o in{"boolean":1,bool:1}?t=!t||t in{0:1,no:1,"false":1}?!1:!0:o in{integer:1,"int":1}?t=parseInt(t,10):"str"===o?t=String(t):"func"===o&&(t||(t=function(){})),"undefined"!=typeof n?e[r][n]=t:e[r]=t},t[r+"_description"]=a,"undefined"==typeof t["get_"+r]&&(t["get_"+r]=l),"undefined"==typeof t["set_"+r]&&(t["set_"+r]=function(t,n){if(i in{RO:1,ro:1})throw r+" is read-only";if(i in{WO:1,wo:1}&&"undefined"!=typeof e[r])throw r+" can only be set once";u(t,n)}),"undefined"!=typeof n[r]?s=n[r]:o in{arr:1,array:1}&&!(s instanceof Array)&&(s=[]),u(s)},Util.conf_defaults=function(e,t,n,r){var i;for(i=0;i<r.length;i++)Util.conf_default(e,t,n,r[i][0],r[i][1],r[i][2],r[i][3],r[i][4])},Util.decodeUTF8=function(e){return decodeURIComponent(escape(e))},Util.get_include_uri=function(){return"undefined"!=typeof INCLUDE_URI?INCLUDE_URI:"include/"},Util._loading_scripts=[],Util._pending_scripts=[],Util.load_scripts=function(e){for(var t,n=document.getElementsByTagName("head")[0],r=Util._loading_scripts,i=Util._pending_scripts,o=0;o<e.length;o++)t=document.createElement("script"),t.type="text/javascript",t.src=Util.get_include_uri()+e[o],t.onload=t.onreadystatechange=function(){for(;r.length>0&&("loaded"===r[0].readyState||"complete"===r[0].readyState);){var e=r.shift();n.appendChild(e)}(!this.readyState||Util.Engine.presto&&"loaded"===this.readyState||"complete"===this.readyState)&&i.indexOf(this)>=0&&(this.onload=this.onreadystatechange=null,i.splice(i.indexOf(this),1),0===i.length&&window.onscriptsload&&window.onscriptsload())},Util.Engine.trident?r.push(t):(t.async=!1,n.appendChild(t)),i.push(t)},Util.getPosition=function(){function e(e,t){if(e.currentStyle)var n=e.currentStyle[t];else if(window.getComputedStyle)var n=window.getComputedStyle(e,null)[t];return n}function t(){var e=0,t=0,n=document.getElementsByTagName("html")[0];return e=n.scrollTop&&document.documentElement.scrollTop?n.scrollTop:n.scrollTop||document.documentElement.scrollTop?n.scrollTop+document.documentElement.scrollTop:document.body.scrollTop?document.body.scrollTop:0,t=n.scrollLeft&&document.documentElement.scrollLeft?n.scrollLeft:n.scrollLeft||document.documentElement.scrollLeft?n.scrollLeft+document.documentElement.scrollLeft:document.body.scrollLeft?document.body.scrollLeft:0,[t,e]}return function(n){for(var r=0,i=0,o=n,s=!1;(o=o.parentNode)&&o!=document.body;)r-=o.scrollLeft||0,i-=o.scrollTop||0,"fixed"==e(o,"position")&&(s=!0);if(s&&!window.opera){var a=t();r+=a[0],i+=a[1]}do r+=n.offsetLeft,i+=n.offsetTop;while(n=n.offsetParent);return{x:r,y:i}}}(),Util.getEventPosition=function(e,t,n){var r,i,o,s;r=e?e:window.event,r=r.changedTouches?r.changedTouches[0]:r.touches?r.touches[0]:r,r.pageX||r.pageY?(i=r.pageX,o=r.pageY):(r.clientX||r.clientY)&&(i=r.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,o=r.clientY+document.body.scrollTop+document.documentElement.scrollTop),s=Util.getPosition(t),"undefined"==typeof n&&(n=1);var a=i-s.x,l=o-s.y,u=Math.max(Math.min(a,t.width-1),0),c=Math.max(Math.min(l,t.height-1),0);return{x:u/n,y:c/n,realx:a/n,realy:l/n}},Util.addEvent=function(e,t,n){if(e.attachEvent){var r=e.attachEvent("on"+t,n);return r}if(e.addEventListener)return e.addEventListener(t,n,!1),!0;throw"Handler could not be attached"},Util.removeEvent=function(e,t,n){if(e.detachEvent){var r=e.detachEvent("on"+t,n);return r}if(e.removeEventListener)return e.removeEventListener(t,n,!1),!0;throw"Handler could not be removed"},Util.stopEvent=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,e.preventDefault?e.preventDefault():e.returnValue=!1},Util.Features={xpath:!!document.evaluate,air:!!window.runtime,query:!!document.querySelector},Util.Engine={presto:function(){return window.opera?!0:!1}(),trident:function(){return window.ActiveXObject?window.XMLHttpRequest?document.querySelectorAll?6:5:4:!1}(),webkit:function(){try{return navigator.taintEnabled?!1:Util.Features.xpath?Util.Features.query?525:420:419}catch(e){return!1}}(),gecko:function(){return document.getBoxObjectFor||null!=window.mozInnerScreenX?document.getElementsByClassName?19:18:!1}()},Util.Engine.webkit&&(Util.Engine.webkit=function(e){var t=new RegExp("WebKit/([0-9.]*) ");return e=(navigator.userAgent.match(t)||["",e])[1],parseFloat(e,10)}(Util.Engine.webkit)),Util.Flash=function(){var e,t;try{e=navigator.plugins["Shockwave Flash"].description}catch(n){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(r){e="0 r0"}}return t=e.match(/\d+/g),{version:parseInt(t[0]||"0."+t[1],10)||0,build:parseInt(t[2],10)||0}}();